#!/usr/bin/env ruby
# encoding: utf-8

$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)
require 'brew-cask-upgrade'

count = Hbc.installed.length

each_installed do |app, i|
  if app[:installed].include? app[:cask].version.to_s
    puts "(#{i+1}/#{count}) #{app[:name]}: up to date"
  else
    puts "(#{i+1}/#{count}) #{app[:name]}: #{app[:installed].join(', ')} -> #{app[:cask].version}"
    system "brew cask install #{app[:name]} --force"
    app[:installed].each do |version|
      system "rm -rf /opt/homebrew-cask/Caskroom/#{app[:name]}/#{version}"
    end
  end
end
